<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Requests — Blood Bond</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1 class="brand">Blood Bond</h1>
      <nav class="nav" aria-label="Main navigation">
        <a href="index.html">Home</a>
        <a href="requests.html" class="active">Requests</a>
        <a href="campaigns.html">Campaigns</a>
      </nav>
      <div style="display:flex;align-items:center;gap:1rem">
        <div id="user-info" style="color:var(--muted);font-size:0.9rem"></div>
        <a href="profile.html"><img src="https://i.pravatar.cc/80" alt="Profile" class="avatar" style="width:40px;height:40px" /></a>
      </div>
    </div>
  </header>

  <main class="container" style="padding-top:2rem">
    <div style="display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:0.75rem;margin-bottom:2rem">
      <button id="view-incoming" class="btn-toggle active">Incoming Requests</button>
      <button id="view-sent" class="btn-toggle">My Sent Requests</button>
    </div>

    <section id="requests-list">
      <div id="requests-container"></div>
    </section>
  </main>

  <footer class="site-footer"><div class="container"><small>© Blood Bond</small></div></footer>

  <script src="auth.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', ()=>{
      const session = BBAuth.requireLogin(); if(!session) return;

      const listEl = document.getElementById('requests-container');
      const viewIncomingBtn = document.getElementById('view-incoming');
      const viewSentBtn = document.getElementById('view-sent');
      let currentView = 'incoming';

      // Sample request data
      const sampleRequests = [
        {id:1, name:'Anita D.', blood:'B+', location:'Square Hospital', time:'2 hours ago', avatar:'https://i.pravatar.cc/150?img=47'},
        {id:2, name:'Rahul S.', blood:'B+', location:'Square Hospital', time:'2 hours ago', avatar:'https://i.pravatar.cc/150?img=12'},
        {id:3, name:'Rahul S.', blood:'B+', location:'Square Hospital', time:'2 hours ago', avatar:'https://i.pravatar.cc/150?img=13'},
        {id:4, name:'Rahul S.', blood:'A+', location:'Square Hospital', time:'2 hours ago', avatar:'https://i.pravatar.cc/150?img=14'},
        {id:5, name:'Anita D.', blood:'B+', location:'Square Hospital', time:'2 hours ago', avatar:'https://i.pravatar.cc/150?img=48'}
      ];

      function loadRequests(){
        listEl.innerHTML = '';
        const requests = currentView === 'incoming' ? sampleRequests : [];
        
        if(requests.length === 0){ 
          listEl.innerHTML = '<p class="muted" style="text-align:center;padding:2rem">No requests yet.</p>'; 
          return;
        }
        
        for(const r of requests){
          const el = document.createElement('div');
          el.className = 'request-card';
          el.innerHTML = `
            <img class="avatar" src="${r.avatar}" alt="${r.name}" />
            <div class="request-info">
              <h3 class="request-name">${r.name}</h3>
              <div class="request-details">Urgent: ${r.blood} Blood needed at ${r.location}</div>
              <div class="request-time">${r.time}</div>
            </div>
            <div class="request-actions">
              <button class="btn-accept" onclick="acceptRequest(${r.id})">Accept</button>
              <button class="btn-reject" onclick="rejectRequest(${r.id})">Reject</button>
            </div>
          `;
          listEl.appendChild(el);
        }
      }

      function setView(view){
        currentView = view;
        viewIncomingBtn.classList.toggle('active', view === 'incoming');
        viewSentBtn.classList.toggle('active', view === 'sent');
        loadRequests();
      }

      viewIncomingBtn.addEventListener('click', ()=> setView('incoming'));
      viewSentBtn.addEventListener('click', ()=> setView('sent'));

      window.acceptRequest = function(id){
        alert('Request accepted! ID: ' + id);
      };

      window.rejectRequest = function(id){
        alert('Request rejected! ID: ' + id);
      };

      loadRequests();
    });
  </script>
</body>
</html>
